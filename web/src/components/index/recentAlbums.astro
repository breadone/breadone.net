---
import SummaryCard from "./summaryCard.astro";
import { authPB } from "@utils/pocketbase";
import { getFormattedDate } from "@utils/date";

const pb = await authPB()

const albums = await pb.collection('albums').getList(1, 3, {
	sort: '-date',
})

const postImages = await Promise.all( albums.items.map(a => pb.files.getURL(a, a.images[0])) )

---
<SummaryCard
    title="Recent Albums",
    titleLink="/albums"
>
    <div class="flex flex-col md:flex-row gap-4 md:gap-4">
        {
            albums.items.map((p, i) => (
            <div class="flex md:flex-col flex-row gap-3 md:gap-2 flex-1">
                <a href={`/albums/${p.slug}`} class="shrink-0">
                    <img class="w-24 h-24 md:w-full md:h-48 object-cover rounded-sm" src={postImages[i]} alt={p.title}/>
                </a>

                <div class="flex flex-col justify-start md:justify-start">
                    <a href={`/albums/${p.slug}`} class="b1-no-underline line-clamp-2 md:line-clamp-none">
                        {p.title}
                    </a>
                </div>
            </div>
            ))
        }
    </div>
</SummaryCard>
